<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>OGforge — Download</title>
    <meta name="theme-color" content="#0b0b10" />
    <link rel="icon" href="logo.svg" type="image/svg+xml" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <main class="wrap">
      <header class="hero">
        <img class="logo" src="logo.svg" alt="OGforge logo" />
        <div>
          <h1>OGforge</h1>
          <p class="sub">Mine. Upgrade. Survive. Your worlds save as files on your computer.</p>
        </div>
      </header>

      <section class="card">
        <h2>Download</h2>
        <p id="status" class="status">Detecting your OS…</p>

        <div class="buttons">
          <a id="dl-win" class="btn" href="downloads/OGforge.exe?v=2" download>Download for Windows (.exe)</a>
          <a id="dl-mac" class="btn" href="downloads/OGforge.dmg?v=2" download>Download for macOS (.dmg)</a>
        </div>

        <div class="fine">
          <p><span class="k">Windows</span> Run the `.exe`.</p>
          <p><span class="k">macOS</span> Open the `.dmg` and drag `OGforge.app` into Applications.</p>
        </div>

        <div class="actions">
          <button id="cancel" class="linkbtn" type="button">Cancel auto-download</button>
        </div>
      </section>

      <footer class="foot">
        <span>OGforge</span>
        <span class="dot">•</span>
        <span class="muted">Black &amp; grey theme</span>
      </footer>
    </main>

    <script>
      (function () {
        const statusEl = document.getElementById('status');
        const cancelEl = document.getElementById('cancel');
        const winLink = document.getElementById('dl-win');
        const macLink = document.getElementById('dl-mac');
        const ua = navigator.userAgent || '';

        const isWindows = /Windows/i.test(ua);
        const isMac = /Macintosh|Mac OS X|Mac_PowerPC|MacIntel/i.test(ua) && !isWindows;

        const target = isWindows ? 'downloads/OGforge.exe?v=2' : isMac ? 'downloads/OGforge.dmg?v=2' : null;
        const label = isWindows ? 'Windows' : isMac ? 'macOS' : 'your OS';
        const linkEl = isWindows ? winLink : isMac ? macLink : null;

        let canceled = false;
        cancelEl.addEventListener('click', () => {
          canceled = true;
          statusEl.textContent = 'Auto-download canceled — pick a download above.';
        });

        if (!target) {
          statusEl.textContent = 'Couldn’t detect your OS — pick a download above.';
          return;
        }

        statusEl.textContent = `Detected ${label}. Starting download… (if it doesn’t start, click the button above)`;

        setTimeout(() => {
          if (canceled) return;
          try {
            if (linkEl && typeof linkEl.click === 'function') linkEl.click();
          } catch {}
          window.location.replace(target);
        }, 900);
      })();
    </script>
  </body>
</html>
